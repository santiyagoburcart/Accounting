{% extends "dashboard/base.html" %}
{% load i18n %}

{% block title %}{% trans "Edit Subscription" %}{% endblock %}
{% block page_title %}{% trans "Edit Subscription" %}{% endblock %}
{% block page_title_desktop %}{% trans "Edit Subscription for" %} {{ subscription.customer.name }}{% endblock %}

{% block content %}
<div class="max-w-2xl mx-auto">
    <div class="glass-card p-8">
        <h2 class="text-2xl font-bold mb-4">{% trans "Editing Subscription" %}</h2>
        <form method="post" class="space-y-4 form-container">
            {% csrf_token %}

            {% if form.errors %}
                <div class="alert alert-error">
                    <p class="font-bold mb-2">{% trans "Please correct the errors below:" %}</p>
                    {{ form.non_field_errors }}
                    <ul class="list-disc list-inside">
                    {% for field in form %}
                        {% for error in field.errors %}
                            <li>{{ field.label }}: {{ error }}</li>
                        {% endfor %}
                    {% endfor %}
                    </ul>
                </div>
            {% endif %}
            {{ form.as_p }}
            <div class="flex items-center gap-4 pt-4">
                <button type="submit" class="w-full btn btn-gradient">{% trans "Save Changes" %}</button>
                <a href="{% url 'dashboard:subscription_dashboard' %}?year={{ subscription.year }}&month={{ subscription.month }}" class="w-full btn btn-secondary text-center">{% trans "Cancel" %}</a>
            </div>
        </form>
    </div>
</div>
{% endblock %}

{% block extra_scripts %}
<script>
    $(document).ready(function() {
        // فعال کردن Select2 برای فیلدهای فرم
        $('#id_customer').select2({ theme: "classic" });
        $('#id_referrer').select2({ theme: "classic", allowClear: true });
        $('#id_destination_bank').select2({ theme: "classic", allowClear: true });
    });
</script>
{% endblock %}